{"version":3,"file":"src/handler.js","mappings":"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","sources":["webpack://docs-site/./src/handler.ts","webpack://docs-site/external commonjs \"aws-sdk\"","webpack://docs-site/webpack/bootstrap","webpack://docs-site/webpack/before-startup","webpack://docs-site/webpack/startup","webpack://docs-site/webpack/after-startup"],"sourcesContent":["// src/handler.ts\r\nimport { APIGatewayEvent, Context, Callback } from 'aws-lambda';\r\nimport AWS from 'aws-sdk';\r\n\r\nconst s3 = new AWS.S3();\r\nconst BUCKET_NAME = process.env.S3_BUCKET_NAME; // This should be set in the environment or serverless config\r\n\r\nexport const listPages = async () => {\r\n  try {\r\n    if (!BUCKET_NAME) {\r\n      throw new Error('S3_BUCKET_NAME is not defined');\r\n    }\r\n\r\n    const response = await s3\r\n      .listObjectsV2({ Bucket: BUCKET_NAME as string, Prefix: \"pages/\" })\r\n      .promise();\r\n\r\n    const files = response.Contents?.map((file) => file.Key) || [];\r\n\r\n    return {\r\n      statusCode: 200,\r\n      body: JSON.stringify({ files }),\r\n    };\r\n  } catch (error) {\r\n    return { statusCode: 500, body: JSON.stringify({ error: (error as Error).message }) };\r\n  }\r\n};\r\n\r\nexport const getMarkdown = async (event: { pathParameters: { filePath: string; }; }) => {\r\n  try {\r\n    console.log('event:', event);\r\n    console.log('event.pathParameters:', event.pathParameters);\r\n    console.log('event.pathParameters.filePath:', event.pathParameters.filePath);\r\n    const { filePath } = event.pathParameters;\r\n    const key = `pages/${filePath}.md`;\r\n\r\n    if (!BUCKET_NAME) {\r\n      throw new Error('S3_BUCKET_NAME is not defined');\r\n    }\r\n\r\n    const response = await s3\r\n      .getObject({ Bucket: BUCKET_NAME as string, Key: key })\r\n      .promise();\r\n\r\n    return {\r\n      statusCode: 200,\r\n      body: JSON.stringify({ content: response.Body ? response.Body.toString(\"utf-8\") : \"\" }),\r\n    };\r\n  } catch (error) {\r\n    console.error(error);\r\n    return { statusCode: 404, body: JSON.stringify({ error: \"File not found\" }) };\r\n  }\r\n};\r\n\r\nexport const uploadMarkdown = async (event: { body: string; }) => {\r\n  try {\r\n    const { fileName, content } = JSON.parse(event.body);\r\n    const key = `pages/${fileName}.md`;\r\n    \r\n    if (!BUCKET_NAME) {\r\n      throw new Error('S3_BUCKET_NAME is not defined');\r\n    }\r\n\r\n    await s3\r\n      .putObject({\r\n        Bucket: BUCKET_NAME,\r\n        Key: key,\r\n        Body: content,\r\n        ContentType: \"text/markdown\",\r\n      })\r\n      .promise();\r\n\r\n    return {\r\n      statusCode: 200,\r\n      body: JSON.stringify({ message: \"File uploaded successfully\", key }),\r\n    };\r\n  } catch (error) {\r\n    return { statusCode: 500, body: JSON.stringify({ error: (error as Error).message }) };\r\n  }\r\n};\r\n\r\n// Handler to create a new page\r\nexport const createPage = async (event: APIGatewayEvent, context: Context, callback: Callback) => {\r\n  const { title, slug, content } = JSON.parse(event.body || '{}');\r\n  const fileName = `${slug}.md`; // Using the slug as the file name\r\n  console.log('Title:', title);\r\n\r\n  if (!BUCKET_NAME) {\r\n    callback(null, {\r\n      statusCode: 500,\r\n      body: JSON.stringify({ message: 'S3_BUCKET_NAME is not defined' }),\r\n    });\r\n    return;\r\n  }\r\n\r\n  // Prepare the S3 upload parameters\r\n  const params = {\r\n    Bucket: BUCKET_NAME,\r\n    Key: fileName,\r\n    Body: content,\r\n    ContentType: 'text/markdown',\r\n  };\r\n\r\n  try {\r\n    // Upload the markdown content to the S3 bucket\r\n    await s3.putObject(params).promise();\r\n    callback(null, {\r\n      statusCode: 201,\r\n      body: JSON.stringify({ message: 'Page created successfully' }),\r\n    });\r\n  } catch (error) {\r\n    callback(null, {\r\n      statusCode: 500,\r\n      body: JSON.stringify({ message: 'Error creating page', error }),\r\n    });\r\n  }\r\n};\r\n\r\n// src/handler.ts\r\nexport const getPage = async (event: APIGatewayEvent, context: Context, callback: Callback) => {\r\n    const slug = event.pathParameters?.slug;\r\n    const fileName = `${slug}.md`; // Use the slug as the file name\r\n  \r\n    // S3 parameters to fetch the file\r\n    if (!BUCKET_NAME) {\r\n      callback(null, {\r\n        statusCode: 500,\r\n        body: JSON.stringify({ message: 'S3_BUCKET_NAME is not defined' }),\r\n        });\r\n      return;\r\n    }\r\n\r\n    const params = {\r\n      Bucket: BUCKET_NAME,\r\n      Key: fileName,\r\n    };\r\n\r\n    try {\r\n      // Get the markdown file from S3\r\n      const data = await s3.getObject(params).promise();\r\n      const content = data.Body?.toString('utf-8') || '';\r\n      callback(null, {\r\n        statusCode: 200,\r\n        body: JSON.stringify({ title: slug, content }), // You could include a title or other metadata here if needed\r\n      });\r\n    } catch (error) {\r\n        console.error(error);\r\n      callback(null, {\r\n        statusCode: 404,\r\n        body: JSON.stringify({ message: 'Page not found' }),\r\n      });\r\n    }\r\n  };\r\n  \r\n","module.exports = require(\"aws-sdk\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(\"./src/handler.ts\");\n",""],"names":[],"sourceRoot":""}